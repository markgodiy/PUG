# PUG Beginner/Intermediate Series - "Remote Sessions"

Topics Covered:
 1. Using VSCode as scripting environment
 2. Working with simple array variables
 3. Working with multiple hosts/servers
 4. Establishing remote shell sessions
 5. Copying files to remote hosts using sessions
 6. Enter sessions and execute command on remote hosts/servers


Commandlets:
 1. `Get-Content`
 2. `New-PSSession` (*Admin)
 3. `Copy-Item`
 4. `Enter-PSSession` (*Admin)
 5. `Invoke-Command` (*Admin)
 6. `Enable-PSRemoting`, or `winrm quickconfig`
* Admin credentials will be necessary to execute some commandlets

## VSCode
Free MicroSoft product with lots of extensions
Native support for PS1 files
Native support for markdown files, and a bunch of other programming/scripting languages

## Arrays
Fundamental programming data structure for storing and organizing data

To identify variable type, you can use the built-in method `gettype()`, e.g., `$var.gettype()`

To count how many elements are in an array, use the built-in method `count()` or `length()`, e.g., `$var.count()`

### Creating a simple array 
```
$objs = "1","2","a","b"
```

### Initializing array variable

In PowerShell, `$_` is the alias for the object being passed down the pipeline. 

```
"1","2","a","b" | Foreach-object {$arr = $arr + $_}
$arr 
#output: 12ab
$arr.count()
#Count: 1
```

When properly initialized
```
$arr = @()
"1","2","a","b" | Foreach-object {$arr = $arr + $_}
$arr
#output: 1,2,a,b
$arr.count()
#count: 4
``` 

### Dynamically 

Note: In PowerShell, `$arr += $_` is equivalent to `$arr = $arr + $_`

Example:
```
$hosts = Get-Content "C:\Path\to\file.txt"

#Initialize array variable
$arr = @()

foreach ($host in $hosts) {
  $host  | Foreach-object {$arr += $_}
}
```




